---
# .github/workflows/release.yml
name: Create a new release

on:
  workflow_dispatch:
    inputs:
      firmware_version:
        description: 'Firmware version'
        required: true
        default: 'latest'

jobs:
  create-release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4.1.7
      - uses: actions/download-artifact@v4.1.7
        with:
          path: output
          name: firmware
          # Specify the build workflow name and job name to download the latest artifact
          # workflow: Build and publish firmware
          # job: build

      - run: |
          mkdir output-release
          cp -r output/* output-release/

      - uses: JamesIves/github-pages-deploy-action@v4.6.1
        with:
          branch: gh-pages-release
          folder: output-release
          clean: true
        
      - name: Create GitHub Release
        uses: "marvinpinto/action-automatic-releases@latest"
        with:
          repo_token: "${{ secrets.MY_TOKEN }}"
          automatic_release_tag: "latest"
          prerelease: true
          title: "Development Build"
          files: |
            manifest.json
            *.bin